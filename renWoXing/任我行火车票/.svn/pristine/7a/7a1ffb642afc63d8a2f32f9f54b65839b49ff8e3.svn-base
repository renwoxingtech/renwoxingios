//
//  ChooseSeatTypeVc.m
//  CommonProject
//
//  Created by mac on 2017/1/17.
//  Copyright © 2017年 mac. All rights reserved.
//

#import "ChooseSeatTypeVc.h"

@interface ChooseSeatTypeVc ()
{
    NSMutableArray *typeArr;
    
}
@end

@implementation ChooseSeatTypeVc

- (void)viewDidLoad {
    [super viewDidLoad];

    self.title = @"选择坐席";
    typeArr = [NSMutableArray array];
    self.selectTypeArr = [NSMutableArray array];
    self.maxCount = 5;
    if (self.issingle) {
        self.maxCount = 1;
    }
    NSArray *nameArr= @[@"商务座",@"一等座",@"二等座",@"软卧",@"软座",@"硬卧",@"硬座"];
    if (self.haveTypeArr.count>0) {
        nameArr = self.haveTypeArr;
        
    }
    for (int i=0; i<nameArr.count; i++) {
        SeatType *type = [[SeatType alloc]init];
        type.name = nameArr[i];
        type.isSelect = NO;
        type.type_name = @"";
        [self.mainDataSource addObject:type];
    }
    
    
    
    [self.mainTableView reloadData];
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return self.mainDataSource.count;
}
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *re4use = @"seattype";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:re4use];
    if (!cell ) {
        cell  = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:re4use];
    }
    SeatType *obj = self.mainDataSource[indexPath.row];
    
    UILabel *l = [cell.contentView viewWithTag:2];
    l.text = obj.name;
    
    UIButton *btn = [cell.contentView viewWithTag:1];
    btn.userInteractionEnabled = NO;
    if (obj.isSelect) {
        
        btn.selected = YES;
    }else{
        btn.selected = NO;
    }
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
    return cell;
}
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    
    DateObject *obj = self.mainDataSource[indexPath.row];
    
    if (obj.isSelect) {
        
    }else
    if (self.selectTypeArr.count>=self.maxCount) {
            [LoadingView showAMessage:[NSString stringWithFormat:@"您最多可以选择%ld个座位类型",self.maxCount]];
            
            return;
    }
    
    
    obj.isSelect = !obj.isSelect;
    if (!obj.isSelect) {
        [self.selectTypeArr removeObject:obj];
    }else{
        if (self.selectTypeArr.count>=self.maxCount) {
            [LoadingView showAMessage:[NSString stringWithFormat:@"您最多可以选择%ld个座位类型",self.maxCount]];
            
            return;
        }
        [self.selectTypeArr addObject:obj];
    }
    if (self.touchEvent) {
        self.touchEvent(self.selectTypeArr);
    }
    [self.mainTableView reloadData];
}

//seattype

@end
